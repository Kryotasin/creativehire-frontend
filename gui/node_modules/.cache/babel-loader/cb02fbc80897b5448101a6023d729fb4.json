{"ast":null,"code":"import\"antd/es/skeleton/style\";import _Skeleton from\"antd/es/skeleton\";import\"antd/es/space/style\";import _Space from\"antd/es/space\";import\"antd/es/upload/style\";import _Upload from\"antd/es/upload\";import\"antd/es/button/style\";import _Button from\"antd/es/button\";import\"antd/es/row/style\";import _Row from\"antd/es/row\";import\"antd/es/col/style\";import _Col from\"antd/es/col\";import\"antd/es/avatar/style\";import _Avatar from\"antd/es/avatar\";import\"antd/es/modal/style\";import _Modal from\"antd/es/modal\";import\"antd/es/input/style\";import _Input from\"antd/es/input\";import\"antd/es/form/style\";import _Form from\"antd/es/form\";import\"antd/es/message/style\";import _message from\"antd/es/message\";import _objectSpread from\"G:\\\\Github\\\\creativehire\\\\frontend\\\\gui\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import\"antd/es/typography/style\";import _Typography from\"antd/es/typography\";import _slicedToArray from\"G:\\\\Github\\\\creativehire\\\\frontend\\\\gui\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import axios from'../axiosConfig';import{UserOutlined,UploadOutlined}from'@ant-design/icons';function UserProfile(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),email=_useState4[0],setEmail=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),name=_useState6[0],setName=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),location=_useState8[0],setLocation=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),img_salt=_useState10[0],setImgSalt=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),img=_useState12[0],setImg=_useState12[1];var Text=_Typography.Text;var typeOfImage=function typeOfImage(proc){return{\"type\":\"profile_pic\",\"process\":proc,\"fileName\":img_salt};};var userProfilePictureUploadProps={name:'file',acceptedFiles:'.png',multiple:false,method:'post',data:typeOfImage(\"upload\"),action:'file-handler/',onRemove:function onRemove(file){console.log(file);axios.post('file-handler/',_objectSpread({\"file\":file.name},typeOfImage('remove')));},onChange:function onChange(info){var status=info.file.status;if(status!=='uploading'){// console.log(info.file, info.fileList);\n}if(status==='done'){_message.success(\"\".concat(info.file.name,\" file uploaded successfully.\"));}else if(status==='error'){_message.error(\"\".concat(info.file.name,\" file upload failed.\"));}reloadProfilePicture();}};var getProfile=function getProfile(){axios.get('userprofile/'+localStorage.getItem('userProfileID')).then(function(res){// Load all profile data\nreloadUsername(res.data['username']);reloadEmail(res.data['email']);reloadName(res.data['name']);reloadLocation(res.data['location']);reloadImgSalt(res.data['img_salt']);setTimeout(function(){return _message.success('Profile loaded successfully.');},100);}).catch(function(err){_message.error(\"Your profile could not be loaded due to \"+err.message);});};var reloadUsername=function reloadUsername(data){setUsername(data);};var reloadEmail=function reloadEmail(data){setEmail(data);};var reloadName=function reloadName(data){setName(data);};var reloadLocation=function reloadLocation(data){setLocation(data);};var reloadImgSalt=function reloadImgSalt(data){setImgSalt(data);};var reloadImg=function reloadImg(data){setImg(data);};var reloadProfilePicture=function reloadProfilePicture(){console.log(typeOfImage('fetch'));axios.post('file-handler/',_objectSpread({},typeOfImage('fetch'))).then(function(res){if(res.status===404){// Set something to show lack of profile picture.\nconsole.log(res);}else if(res.status===200&&res.data!=='ErrorResponseMetadata'){console.log(res);reloadImg(res.data);}}).catch(function(err){console.log(err);});};var CollectionCreateForm=function CollectionCreateForm(_ref){var visible=_ref.visible,onCreate=_ref.onCreate,onCancel=_ref.onCancel;var _Form$useForm=_Form.useForm(),_Form$useForm2=_slicedToArray(_Form$useForm,1),form=_Form$useForm2[0];return React.createElement(_Modal,{visible:visible,title:\"Update Profile\",okText:\"Update\",cancelText:\"Cancel\",onCancel:onCancel,onOk:function onOk(){form.validateFields().then(function(values){form.resetFields();onCreate(values);}).catch(function(info){console.log('Validate Failed:',info);});}},React.createElement(_Form,{form:form,layout:\"vertical\",name:\"form_in_modal\",initialValues:{modifier:'public'}},React.createElement(_Form.Item,{name:\"name\",label:\"Name\",rules:[{message:'Please input your full name.'}]},React.createElement(_Input,{placeholder:name})),React.createElement(_Form.Item,{name:\"emil\",label:\"Email\",rules:[{message:'Please input your email.',type:'email'}]},React.createElement(_Input,{placeholder:email})),React.createElement(_Form.Item,{name:\"location\",label:\"Location\",rules:[{message:'Please input your Location.'}]},React.createElement(_Input,{placeholder:location}))));};var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),visible=_useState14[0],setVisible=_useState14[1];var onCreate=function onCreate(values){console.log('Received values of form: ',values);var newEmail=values.email==null?email:values.email;var newName=values.name==null?name:values.name;var newLocation=values.location==null?location:values.location;axios.put('userprofile/update/'+localStorage.getItem('userProfileID'),{email:newEmail,name:newName,location:newLocation}).then(function(res){reloadEmail(res.data['email']);reloadName(res.data['name']);reloadLocation(res.data['location']);reloadImgSalt(res.data['img_salt']);setTimeout(function(){return _message.success('Profile updated successfully!');},100);}).catch(function(err){_message.error(\"Your profile could not be updated due to \"+err.message);});setVisible(false);};useEffect(function(){getProfile();},[]);return React.createElement(\"div\",null,reloadProfilePicture(),React.createElement(_Row,{gutter:[8,48]},React.createElement(_Col,{xs:{span:6,offset:1},lg:{span:6,offset:2}},img==null?React.createElement(_Avatar,{shape:\"square\",size:\"large\",icon:React.createElement(UserOutlined,null)}):React.createElement(\"img\",{src:\"data:image/png;base64,\".concat(img)})),React.createElement(_Col,{xs:{span:5,offset:1},lg:{span:6,offset:2}},React.createElement(\"h1\",null,\"Your Profile\"))),React.createElement(_Row,{gutter:[8,20]},React.createElement(_Col,{xs:{span:6,offset:2},lg:{span:6,offset:2}},React.createElement(_Upload,userProfilePictureUploadProps,React.createElement(_Button,{size:\"small\"},\"Change Picture\"))),React.createElement(_Col,{xs:{span:8,offset:1},lg:{span:6,offset:2}},React.createElement(_Space,{size:\"large\"},React.createElement(\"p\",null,\"Username: \"),React.createElement(\"p\",null,username==null?React.createElement(Text,{type:\"danger\"},\"No username found!\"):username)))),React.createElement(_Row,{gutter:[8,20]},React.createElement(_Col,{xs:{span:6,offset:2},lg:{span:6,offset:2}}),React.createElement(_Col,{xs:{span:8,offset:1},lg:{span:6,offset:2}},React.createElement(_Space,{size:\"large\"},React.createElement(\"p\",null,\"Name: \"),React.createElement(\"p\",null,name==null?React.createElement(Text,{type:\"danger\"},\"No name found!\"):name)))),React.createElement(_Row,{gutter:[8,20]},React.createElement(_Col,{xs:{span:6,offset:2},lg:{span:6,offset:2}}),React.createElement(_Col,{xs:{span:8,offset:1},lg:{span:6,offset:2}},React.createElement(_Space,{size:\"large\"},React.createElement(\"p\",null,\"Email: \"),React.createElement(\"p\",null,email==null?React.createElement(_Skeleton,{active:true}):email)))),React.createElement(_Row,{gutter:[8,20]},React.createElement(_Col,{xs:{span:6,offset:2},lg:{span:6,offset:2}}),React.createElement(_Col,{xs:{span:8,offset:1},lg:{span:6,offset:2}},React.createElement(_Space,{size:\"large\"},React.createElement(\"p\",null,\"Location: \"),React.createElement(\"p\",null,location==null?React.createElement(Text,{type:\"danger\"},\"No location set!\"):location)))),React.createElement(_Row,{gutter:[8,20]},React.createElement(_Col,{xs:{span:6,offset:2},lg:{span:6,offset:2}}),React.createElement(_Col,{xs:{span:8,offset:1},lg:{span:6,offset:2}},React.createElement(_Button,{type:\"primary\",onClickCapture:function onClickCapture(){return setVisible(true);}},\"Edit\"))),React.createElement(CollectionCreateForm,{visible:visible,onCreate:onCreate,onCancel:function onCancel(){setVisible(false);}}));}export default UserProfile;","map":{"version":3,"sources":["G:/Github/creativehire/frontend/gui/src/containers/Profile.js"],"names":["React","useState","useEffect","axios","UserOutlined","UploadOutlined","UserProfile","username","setUsername","email","setEmail","name","setName","location","setLocation","img_salt","setImgSalt","img","setImg","Text","typeOfImage","proc","userProfilePictureUploadProps","acceptedFiles","multiple","method","data","action","onRemove","file","console","log","post","onChange","info","status","success","error","reloadProfilePicture","getProfile","get","localStorage","getItem","then","res","reloadUsername","reloadEmail","reloadName","reloadLocation","reloadImgSalt","setTimeout","catch","err","message","reloadImg","CollectionCreateForm","visible","onCreate","onCancel","useForm","form","validateFields","values","resetFields","modifier","type","setVisible","newEmail","newName","newLocation","put","span","offset"],"mappings":"qkCAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA4C,OAA5C,CAGA,MAAOC,CAAAA,KAAP,KAAkB,gBAAlB,CACA,OAASC,YAAT,CAAuBC,cAAvB,KAA6C,mBAA7C,CAIA,QAASC,CAAAA,WAAT,EAAuB,eACYL,QAAQ,CAAC,EAAD,CADpB,wCACbM,QADa,eACHC,WADG,8BAEMP,QAAQ,CAAC,EAAD,CAFd,yCAEbQ,KAFa,eAENC,QAFM,8BAGIT,QAAQ,CAAC,EAAD,CAHZ,yCAGbU,IAHa,eAGPC,OAHO,8BAIYX,QAAQ,CAAC,EAAD,CAJpB,yCAIbY,QAJa,eAIHC,WAJG,8BAKWb,QAAQ,CAAC,EAAD,CALnB,0CAKbc,QALa,gBAKHC,UALG,gCAMEf,QAAQ,CAAC,IAAD,CANV,2CAMbgB,GANa,gBAMRC,MANQ,mBAQXC,CAAAA,IARW,aAQXA,IARW,CAWnB,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,IAAD,CAAU,CAC1B,MAAO,CAAC,OAAS,aAAV,CAAyB,UAAWA,IAApC,CAA0C,WAAYN,QAAtD,CAAP,CACH,CAFD,CAIA,GAAMO,CAAAA,6BAA6B,CAAG,CAClCX,IAAI,CAAE,MAD4B,CAElCY,aAAa,CAAE,MAFmB,CAGlCC,QAAQ,CAAE,KAHwB,CAIlCC,MAAM,CAAE,MAJ0B,CAKlCC,IAAI,CAAEN,WAAW,CAAC,QAAD,CALiB,CAMlCO,MAAM,CAAE,eAN0B,CAOlCC,QAPkC,mBAOzBC,IAPyB,CAOpB,CAEVC,OAAO,CAACC,GAAR,CAAYF,IAAZ,EAEA1B,KAAK,CAAC6B,IAAN,CAAW,eAAX,gBACI,OAAQH,IAAI,CAAClB,IADjB,EAEOS,WAAW,CAAC,QAAD,CAFlB,GAKH,CAhBiC,CAkBlCa,QAlBkC,mBAkBzBC,IAlByB,CAkBnB,IACLC,CAAAA,MADK,CACMD,IAAI,CAACL,IADX,CACLM,MADK,CAEb,GAAIA,MAAM,GAAK,WAAf,CAA4B,CAC1B;AACD,CACD,GAAIA,MAAM,GAAK,MAAf,CAAuB,CACrB,SAAQC,OAAR,WAAmBF,IAAI,CAACL,IAAL,CAAUlB,IAA7B,kCACD,CAFD,IAEO,IAAIwB,MAAM,GAAK,OAAf,CAAwB,CAC7B,SAAQE,KAAR,WAAiBH,IAAI,CAACL,IAAL,CAAUlB,IAA3B,0BACD,CACD2B,oBAAoB,GACrB,CA7BiC,CAAtC,CAgCA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACzBpC,KAAK,CAACqC,GAAN,CAAU,eAAiBC,YAAY,CAACC,OAAb,CAAqB,eAArB,CAA3B,EACCC,IADD,CACO,SAAAC,GAAG,CAAI,CACV;AAGAC,cAAc,CAACD,GAAG,CAAClB,IAAJ,CAAS,UAAT,CAAD,CAAd,CACAoB,WAAW,CAACF,GAAG,CAAClB,IAAJ,CAAS,OAAT,CAAD,CAAX,CACAqB,UAAU,CAACH,GAAG,CAAClB,IAAJ,CAAS,MAAT,CAAD,CAAV,CACAsB,cAAc,CAACJ,GAAG,CAAClB,IAAJ,CAAS,UAAT,CAAD,CAAd,CACAuB,aAAa,CAACL,GAAG,CAAClB,IAAJ,CAAS,UAAT,CAAD,CAAb,CAEAwB,UAAU,CAAC,iBAAM,UAAQd,OAAR,CAAgB,8BAAhB,CAAN,EAAD,CAAwD,GAAxD,CAAV,CACC,CAZL,EAcCe,KAdD,CAcO,SAAAC,GAAG,CAAI,CACV,SAAQf,KAAR,CAAc,2CAA6Ce,GAAG,CAACC,OAA/D,EACH,CAhBD,EAiBC,CAlBD,CAoBA,GAAMR,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACnB,IAAD,CAAU,CAC7BlB,WAAW,CAACkB,IAAD,CAAX,CACH,CAFD,CAIA,GAAMoB,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACpB,IAAD,CAAU,CAC1BhB,QAAQ,CAACgB,IAAD,CAAR,CACH,CAFD,CAIA,GAAMqB,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACrB,IAAD,CAAU,CACzBd,OAAO,CAACc,IAAD,CAAP,CACH,CAFD,CAIA,GAAMsB,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACtB,IAAD,CAAU,CAC7BZ,WAAW,CAACY,IAAD,CAAX,CACH,CAFD,CAIA,GAAMuB,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACvB,IAAD,CAAU,CAC5BV,UAAU,CAACU,IAAD,CAAV,CACH,CAFD,CAIA,GAAM4B,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAAC5B,IAAD,CAAU,CACxBR,MAAM,CAACQ,IAAD,CAAN,CACH,CAFD,CAIA,GAAMY,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,EAAM,CAC/BR,OAAO,CAACC,GAAR,CAAYX,WAAW,CAAC,OAAD,CAAvB,EACAjB,KAAK,CAAC6B,IAAN,CAAW,eAAX,kBACOZ,WAAW,CAAC,OAAD,CADlB,GAGCuB,IAHD,CAII,SAAAC,GAAG,CAAI,CAEP,GAAGA,GAAG,CAACT,MAAJ,GAAe,GAAlB,CAAsB,CAClB;AACAL,OAAO,CAACC,GAAR,CAAYa,GAAZ,EACH,CAHD,IAKK,IAAIA,GAAG,CAACT,MAAJ,GAAe,GAAf,EAAsBS,GAAG,CAAClB,IAAJ,GAAa,uBAAvC,CAA+D,CAChEI,OAAO,CAACC,GAAR,CAAYa,GAAZ,EACAU,SAAS,CAACV,GAAG,CAAClB,IAAL,CAAT,CACH,CACJ,CAfD,EAgBCyB,KAhBD,CAgBO,SAAAC,GAAG,CAAI,CACVtB,OAAO,CAACC,GAAR,CAAYqB,GAAZ,EACH,CAlBD,EAmBH,CArBD,CAuBA,GAAMG,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,MAAqC,IAAlCC,CAAAA,OAAkC,MAAlCA,OAAkC,CAAzBC,QAAyB,MAAzBA,QAAyB,CAAfC,QAAe,MAAfA,QAAe,mBAC/C,MAAKC,OAAL,EAD+C,gDACvDC,IADuD,mBAE9D,MACE,6BACE,OAAO,CAAEJ,OADX,CAEE,KAAK,CAAC,gBAFR,CAGE,MAAM,CAAC,QAHT,CAIE,UAAU,CAAC,QAJb,CAKE,QAAQ,CAAEE,QALZ,CAME,IAAI,CAAE,eAAM,CACVE,IAAI,CACDC,cADH,GAEGlB,IAFH,CAEQ,SAAAmB,MAAM,CAAI,CACdF,IAAI,CAACG,WAAL,GACAN,QAAQ,CAACK,MAAD,CAAR,CACD,CALH,EAMGX,KANH,CAMS,SAAAjB,IAAI,CAAI,CACbJ,OAAO,CAACC,GAAR,CAAY,kBAAZ,CAAgCG,IAAhC,EACD,CARH,EASD,CAhBH,EAkBE,2BACE,IAAI,CAAE0B,IADR,CAEE,MAAM,CAAC,UAFT,CAGE,IAAI,CAAC,eAHP,CAIE,aAAa,CAAE,CACbI,QAAQ,CAAE,QADG,CAJjB,EAQE,0BAAM,IAAN,EACE,IAAI,CAAC,MADP,CAEE,KAAK,CAAC,MAFR,CAGE,KAAK,CAAE,CACL,CACEX,OAAO,CAAE,8BADX,CADK,CAHT,EASE,4BAAO,WAAW,CAAE1C,IAApB,EATF,CARF,CAoBE,0BAAM,IAAN,EACE,IAAI,CAAC,MADP,CAEE,KAAK,CAAC,OAFR,CAGE,KAAK,CAAE,CACL,CACE0C,OAAO,CAAE,0BADX,CAEEY,IAAI,CAAE,OAFR,CADK,CAHT,EAUE,4BAAO,WAAW,CAAExD,KAApB,EAVF,CApBF,CAiCE,0BAAM,IAAN,EACE,IAAI,CAAC,UADP,CAEE,KAAK,CAAC,UAFR,CAGE,KAAK,CAAE,CACL,CACE4C,OAAO,CAAE,6BADX,CADK,CAHT,EASE,4BAAO,WAAW,CAAExC,QAApB,EATF,CAjCF,CAlBF,CADF,CAkED,CApEH,CAlHmB,gBAyLeZ,QAAQ,CAAC,KAAD,CAzLvB,2CAyLRuD,OAzLQ,gBAyLCU,UAzLD,gBA4Lf,GAAMT,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAAAK,MAAM,CAAI,CACvBhC,OAAO,CAACC,GAAR,CAAY,2BAAZ,CAAyC+B,MAAzC,EAEA,GAAIK,CAAAA,QAAQ,CAAGL,MAAM,CAACrD,KAAP,EAAgB,IAAhB,CAAuBA,KAAvB,CAA+BqD,MAAM,CAACrD,KAArD,CACA,GAAI2D,CAAAA,OAAO,CAAGN,MAAM,CAACnD,IAAP,EAAe,IAAf,CAAsBA,IAAtB,CAA6BmD,MAAM,CAACnD,IAAlD,CACA,GAAI0D,CAAAA,WAAW,CAAGP,MAAM,CAACjD,QAAP,EAAmB,IAAnB,CAA0BA,QAA1B,CAAqCiD,MAAM,CAACjD,QAA9D,CAEAV,KAAK,CAACmE,GAAN,CAAU,sBAAwB7B,YAAY,CAACC,OAAb,CAAqB,eAArB,CAAlC,CAAwE,CACpEjC,KAAK,CAAE0D,QAD6D,CAEpExD,IAAI,CAAEyD,OAF8D,CAGpEvD,QAAQ,CAAEwD,WAH0D,CAAxE,EAKC1B,IALD,CAKM,SAAAC,GAAG,CAAI,CACTE,WAAW,CAACF,GAAG,CAAClB,IAAJ,CAAS,OAAT,CAAD,CAAX,CACAqB,UAAU,CAACH,GAAG,CAAClB,IAAJ,CAAS,MAAT,CAAD,CAAV,CACAsB,cAAc,CAACJ,GAAG,CAAClB,IAAJ,CAAS,UAAT,CAAD,CAAd,CACAuB,aAAa,CAACL,GAAG,CAAClB,IAAJ,CAAS,UAAT,CAAD,CAAb,CACAwB,UAAU,CAAC,iBAAM,UAAQd,OAAR,CAAgB,+BAAhB,CAAN,EAAD,CAAyD,GAAzD,CAAV,CACH,CAXD,EAYCe,KAZD,CAYO,SAAAC,GAAG,CAAI,CACV,SAAQf,KAAR,CAAc,4CAA8Ce,GAAG,CAACC,OAAhE,EACH,CAdD,EAiBAa,UAAU,CAAC,KAAD,CAAV,CACH,CAzBD,CA4BJhE,SAAS,CAAC,UAAM,CACZqC,UAAU,GACb,CAFQ,CAEN,EAFM,CAAT,CAMA,MACQ,gCACKD,oBAAoB,EADzB,CAGI,0BAAK,MAAM,CAAE,CAAC,CAAD,CAAI,EAAJ,CAAb,EACI,0BAAK,EAAE,CAAE,CAAEiC,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAAT,CAAiC,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAArC,EAEQvD,GAAG,EAAI,IAAP,CACI,6BAAQ,KAAK,CAAC,QAAd,CAAuB,IAAI,CAAC,OAA5B,CAAoC,IAAI,CAAG,oBAAC,YAAD,MAA3C,EADJ,CAGA,2BAAK,GAAG,iCAA2BA,GAA3B,CAAR,EALR,CADJ,CASI,0BAAK,EAAE,CAAE,CAAEsD,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAAT,CAAiC,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAArC,EACI,6CADJ,CATJ,CAHJ,CAiBI,0BAAK,MAAM,CAAE,CAAC,CAAD,CAAI,EAAJ,CAAb,EACI,0BAAK,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAAT,CAAiC,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAArC,EACI,4BAAYlD,6BAAZ,CACI,6BACI,IAAI,CAAC,OADT,mBADJ,CADJ,CADJ,CASI,0BAAK,EAAE,CAAE,CAAEiD,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAAT,CAAiC,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAArC,EACI,4BAAO,IAAI,CAAG,OAAd,EACI,0CADJ,CAEI,6BAAIjE,QAAQ,EAAI,IAAZ,CAAmB,oBAAC,IAAD,EAAM,IAAI,CAAC,QAAX,uBAAnB,CAAmEA,QAAvE,CAFJ,CADJ,CATJ,CAjBJ,CAkCI,0BAAK,MAAM,CAAE,CAAC,CAAD,CAAI,EAAJ,CAAb,EACI,0BAAK,EAAE,CAAE,CAAEgE,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAAT,CAAiC,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAArC,EADJ,CAGI,0BAAK,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAAT,CAAiC,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAArC,EACI,4BAAO,IAAI,CAAG,OAAd,EACI,sCADJ,CAEI,6BAAI7D,IAAI,EAAI,IAAR,CAAe,oBAAC,IAAD,EAAM,IAAI,CAAC,QAAX,mBAAf,CAA2DA,IAA/D,CAFJ,CADJ,CAHJ,CAlCJ,CA6CI,0BAAK,MAAM,CAAE,CAAC,CAAD,CAAI,EAAJ,CAAb,EACI,0BAAK,EAAE,CAAE,CAAE4D,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAAT,CAAiC,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAArC,EADJ,CAGI,0BAAK,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAAT,CAAiC,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAArC,EACI,4BAAO,IAAI,CAAG,OAAd,EACI,uCADJ,CAEI,6BAAI/D,KAAK,EAAI,IAAT,CAAgB,+BAAU,MAAM,KAAhB,EAAhB,CAAsCA,KAA1C,CAFJ,CADJ,CAHJ,CA7CJ,CAwDI,0BAAK,MAAM,CAAE,CAAC,CAAD,CAAI,EAAJ,CAAb,EACI,0BAAK,EAAE,CAAE,CAAE8D,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAAT,CAAiC,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAArC,EADJ,CAGI,0BAAK,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAAT,CAAiC,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAArC,EACI,4BAAO,IAAI,CAAG,OAAd,EACI,0CADJ,CAEI,6BAAI3D,QAAQ,EAAI,IAAZ,CAAmB,oBAAC,IAAD,EAAM,IAAI,CAAC,QAAX,qBAAnB,CAAiEA,QAArE,CAFJ,CADJ,CAHJ,CAxDJ,CAmEI,0BAAK,MAAM,CAAE,CAAC,CAAD,CAAI,EAAJ,CAAb,EACI,0BAAK,EAAE,CAAE,CAAE0D,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAAT,CAAiC,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAArC,EADJ,CAII,0BAAK,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAAT,CAAiC,EAAE,CAAE,CAAED,IAAI,CAAE,CAAR,CAAWC,MAAM,CAAE,CAAnB,CAArC,EACI,6BAAQ,IAAI,CAAC,SAAb,CAAuB,cAAc,CAAE,gCAAMN,CAAAA,UAAU,CAAC,IAAD,CAAhB,EAAvC,SADJ,CAJJ,CAnEJ,CA4EQ,oBAAC,oBAAD,EACI,OAAO,CAAEV,OADb,CAEI,QAAQ,CAAEC,QAFd,CAGI,QAAQ,CAAE,mBAAM,CAChBS,UAAU,CAAC,KAAD,CAAV,CACC,CALL,EA5ER,CADR,CAsFH,CAED,cAAe5D,CAAAA,WAAf","sourcesContent":["import React, { useState, useEffect }  from 'react';\r\nimport { Modal, Form, Input, Row, Col, Avatar, Upload, Button, message, Skeleton, Space, Typography  } from 'antd';\r\n\r\nimport axios from '../axiosConfig';\r\nimport { UserOutlined, UploadOutlined } from '@ant-design/icons';\r\n\r\n\r\n\r\nfunction UserProfile() {\r\n    const[username, setUsername] = useState('');\r\n    const[email, setEmail] = useState('');\r\n    const[name, setName] = useState('');\r\n    const[location, setLocation] = useState('');\r\n    const[img_salt, setImgSalt] = useState('');\r\n    const[img, setImg] = useState(null);\r\n\r\n    const { Text } = Typography;\r\n\r\n\r\n    const typeOfImage = (proc) => {\r\n        return {\"type\" : \"profile_pic\", \"process\": proc, \"fileName\": img_salt}\r\n    }\r\n    \r\n    const userProfilePictureUploadProps = {\r\n        name: 'file',\r\n        acceptedFiles: '.png',\r\n        multiple: false,\r\n        method: 'post',\r\n        data: typeOfImage(\"upload\"),\r\n        action: 'file-handler/',\r\n        onRemove(file){\r\n\r\n            console.log(file);\r\n            \r\n            axios.post('file-handler/', {\r\n                \"file\": file.name,\r\n                ...typeOfImage('remove')\r\n            });\r\n\r\n        },\r\n        \r\n        onChange(info) {\r\n          const { status } = info.file;\r\n          if (status !== 'uploading') {\r\n            // console.log(info.file, info.fileList);\r\n          }\r\n          if (status === 'done') {\r\n            message.success(`${info.file.name} file uploaded successfully.`);\r\n          } else if (status === 'error') {\r\n            message.error(`${info.file.name} file upload failed.`);\r\n          }\r\n          reloadProfilePicture();\r\n        },\r\n      };\r\n\r\n    const getProfile = () => {\r\n    axios.get('userprofile/' + localStorage.getItem('userProfileID'))\r\n    .then( res => {\r\n        // Load all profile data\r\n\r\n\r\n        reloadUsername(res.data['username']);\r\n        reloadEmail(res.data['email']);\r\n        reloadName(res.data['name']);\r\n        reloadLocation(res.data['location']);\r\n        reloadImgSalt(res.data['img_salt']);\r\n\r\n        setTimeout(() => message.success('Profile loaded successfully.'), 100);\r\n        }\r\n    )\r\n    .catch(err => {\r\n        message.error(`Your profile could not be loaded due to ` + err.message);\r\n    })\r\n    }\r\n\r\n    const reloadUsername = (data) => {\r\n        setUsername(data);\r\n    }\r\n\r\n    const reloadEmail = (data) => {\r\n        setEmail(data);\r\n    }\r\n\r\n    const reloadName = (data) => {\r\n        setName(data);\r\n    }\r\n\r\n    const reloadLocation = (data) => {\r\n        setLocation(data);\r\n    }\r\n\r\n    const reloadImgSalt = (data) => {\r\n        setImgSalt(data);\r\n    }\r\n\r\n    const reloadImg = (data) => {\r\n        setImg(data);\r\n    }\r\n\r\n    const reloadProfilePicture = () => {\r\n        console.log(typeOfImage('fetch'));\r\n        axios.post('file-handler/', {\r\n            ...typeOfImage('fetch')\r\n        })\r\n        .then(\r\n            res => {\r\n\r\n            if(res.status === 404){\r\n                // Set something to show lack of profile picture.\r\n                console.log(res);\r\n            }\r\n\r\n            else if (res.status === 200 && res.data !== 'ErrorResponseMetadata'){\r\n                console.log(res)\r\n                reloadImg(res.data);\r\n            }\r\n        })\r\n        .catch(err => {\r\n            console.log(err);\r\n        })\r\n    }\r\n\r\n    const CollectionCreateForm = ({ visible, onCreate, onCancel }) => {\r\n        const [form] = Form.useForm();\r\n        return (\r\n          <Modal\r\n            visible={visible}\r\n            title=\"Update Profile\"\r\n            okText=\"Update\"\r\n            cancelText=\"Cancel\"\r\n            onCancel={onCancel}\r\n            onOk={() => {\r\n              form\r\n                .validateFields()\r\n                .then(values => {\r\n                  form.resetFields();\r\n                  onCreate(values);\r\n                })\r\n                .catch(info => {\r\n                  console.log('Validate Failed:', info);\r\n                });\r\n            }}\r\n          >\r\n            <Form\r\n              form={form}\r\n              layout=\"vertical\"\r\n              name=\"form_in_modal\"\r\n              initialValues={{\r\n                modifier: 'public',\r\n              }}\r\n            >\r\n              <Form.Item\r\n                name=\"name\"\r\n                label=\"Name\"\r\n                rules={[\r\n                  {\r\n                    message: 'Please input your full name.',\r\n                  },\r\n                ]}\r\n              >\r\n                <Input placeholder={name}/>\r\n              </Form.Item>\r\n\r\n              <Form.Item\r\n                name=\"emil\"\r\n                label=\"Email\"\r\n                rules={[\r\n                  {\r\n                    message: 'Please input your email.',\r\n                    type: 'email'\r\n                  },\r\n                ]}\r\n              >\r\n                <Input placeholder={email} />\r\n              </Form.Item>\r\n\r\n              <Form.Item\r\n                name=\"location\"\r\n                label=\"Location\"\r\n                rules={[\r\n                  {\r\n                    message: 'Please input your Location.',\r\n                  },\r\n                ]}\r\n              >\r\n                <Input placeholder={location}/>\r\n              </Form.Item>\r\n            </Form>\r\n          </Modal>\r\n        );\r\n      };\r\n\r\n\r\n        const [visible, setVisible] = useState(false);\r\n    \r\n      \r\n        const onCreate = values => {\r\n            console.log('Received values of form: ', values);\r\n            \r\n            var newEmail = values.email == null ? email : values.email;\r\n            var newName = values.name == null ? name : values.name;\r\n            var newLocation = values.location == null ? location : values.location;\r\n            \r\n            axios.put('userprofile/update/' + localStorage.getItem('userProfileID'),{\r\n                email: newEmail,\r\n                name: newName,\r\n                location: newLocation\r\n            })\r\n            .then(res => {\r\n                reloadEmail(res.data['email']);\r\n                reloadName(res.data['name']);\r\n                reloadLocation(res.data['location']);\r\n                reloadImgSalt(res.data['img_salt']);\r\n                setTimeout(() => message.success('Profile updated successfully!'), 100);\r\n            })\r\n            .catch(err => {\r\n                message.error(`Your profile could not be updated due to ` + err.message);\r\n            })\r\n\r\n            \r\n            setVisible(false);\r\n        }\r\n\r\n\r\n    useEffect(() => {\r\n        getProfile();\r\n    }, []); \r\n\r\n\r\n\r\n    return (\r\n            <div>  \r\n                {reloadProfilePicture()}\r\n                \r\n                <Row gutter={[8, 48]}>\r\n                    <Col xs={{ span: 6, offset: 1 }} lg={{ span: 6, offset: 2 }}>\r\n                        { \r\n                            img == null?\r\n                                <Avatar shape=\"square\" size=\"large\" icon={ <UserOutlined />}/>\r\n                            :\r\n                            <img src={`data:image/png;base64,${img}`} />                        \r\n                        }   \r\n                    </Col>\r\n                    <Col xs={{ span: 5, offset: 1 }} lg={{ span: 6, offset: 2 }}>\r\n                        <h1>Your Profile</h1>\r\n                    </Col>\r\n                </Row>\r\n\r\n                <Row gutter={[8, 20]}>\r\n                    <Col xs={{ span: 6, offset: 2 }} lg={{ span: 6, offset: 2 }}>\r\n                        <Upload {...userProfilePictureUploadProps}>\r\n                            <Button\r\n                                size=\"small\">\r\n                                Change Picture\r\n                            </Button>\r\n                        </Upload>\r\n                    </Col>\r\n                    <Col xs={{ span: 8, offset: 1 }} lg={{ span: 6, offset: 2 }}>\r\n                        <Space size = \"large\">\r\n                            <p>Username: </p>\r\n                            <p>{username == null ? <Text type=\"danger\">No username found!</Text> : username}</p>\r\n                        </Space>\r\n                    </Col>\r\n                </Row>\r\n\r\n                <Row gutter={[8, 20]}>\r\n                    <Col xs={{ span: 6, offset: 2 }} lg={{ span: 6, offset: 2 }}>\r\n                    </Col>\r\n                    <Col xs={{ span: 8, offset: 1 }} lg={{ span: 6, offset: 2 }}>\r\n                        <Space size = \"large\">\r\n                            <p>Name: </p>\r\n                            <p>{name == null ? <Text type=\"danger\">No name found!</Text> : name}</p>\r\n                        </Space>                \r\n                    </Col>\r\n                </Row>\r\n\r\n                <Row gutter={[8, 20]}>\r\n                    <Col xs={{ span: 6, offset: 2 }} lg={{ span: 6, offset: 2 }}>\r\n                    </Col>\r\n                    <Col xs={{ span: 8, offset: 1 }} lg={{ span: 6, offset: 2 }}>\r\n                        <Space size = \"large\">\r\n                            <p>Email: </p>\r\n                            <p>{email == null ? <Skeleton active /> : email}</p>\r\n                        </Space>\r\n                    </Col>\r\n                </Row>\r\n\r\n                <Row gutter={[8, 20]}>\r\n                    <Col xs={{ span: 6, offset: 2 }} lg={{ span: 6, offset: 2 }}>\r\n                    </Col>\r\n                    <Col xs={{ span: 8, offset: 1 }} lg={{ span: 6, offset: 2 }}>\r\n                        <Space size = \"large\">\r\n                            <p>Location: </p>\r\n                            <p>{location == null ? <Text type=\"danger\">No location set!</Text> : location}</p>\r\n                        </Space>                \r\n                    </Col>\r\n                </Row>\r\n\r\n                <Row gutter={[8, 20]}>\r\n                    <Col xs={{ span: 6, offset: 2 }} lg={{ span: 6, offset: 2 }}>\r\n                    </Col>\r\n\r\n                    <Col xs={{ span: 8, offset: 1 }} lg={{ span: 6, offset: 2 }}>\r\n                        <Button type=\"primary\" onClickCapture={() => setVisible(true)}>Edit</Button>\r\n                    </Col>\r\n                </Row>\r\n\r\n                    <CollectionCreateForm\r\n                        visible={visible}\r\n                        onCreate={onCreate}\r\n                        onCancel={() => {\r\n                        setVisible(false);\r\n                        }}\r\n                    />\r\n            </div>\r\n    )\r\n}\r\n\r\nexport default UserProfile;\r\n"]},"metadata":{},"sourceType":"module"}